/**
     ** Fresque Kelprof - Site internet pour la fresque du savoir Kelprof
     ** @author: eric.guittiere@fullsix.com - Eric Guittiere
     ** @version: 0.0.0
     **/
     "use strict";function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}/**
 * rkgttr-q
 *
 * Copyright © 2016 Erik Guittiere. All rights reserved.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.txt file in the root directory of this source tree.
 */
function one(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return t.querySelector(e)||t.createElement("div")}function id(e){return document.getElementById(e)||document.createElement("div")}function whichAnimationEvent(){var e=void 0,t=document.createElement("div"),r={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"Animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in r)if(void 0!==t.style[e])return r[e]}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),Router=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};if(_classCallCheck(this,e),void 0===window.routerInstance){window.routerInstance=this,this.routes=[],this.matchers=[],this.lookup={},this["default"]=function(){return r()},this.currentRoute={route:"",results:[]};var n=function(e){var r=(e.newURL||document.location.hash).slice((e.newURL||document.location.hash).indexOf("#")),n=0;return t.matchers.forEach(function(o,i){var a=r.match(o);a&&a.length>n&&(n=a.length,t.currentRoute.route=t.routes[i],t.currentRoute.result=a.filter(function(e){return"string"==typeof e}).slice(1),t.currentRoute.result.push(e))}),"function"==typeof t.lookup[t.currentRoute.route]&&n>0?t.lookup[t.currentRoute.route]():t["default"]()};window.addEventListener("hashchange",n),this.dispatch()}return window.routerInstance}return _createClass(e,[{key:"callRoute",value:function(e){if(0!==e.indexOf("#"))throw new Error("Your route should start with a #");document.location.href=e}},{key:"extendRoute",value:function(e,t){var r=this,n=this.lookup[e];this.lookup[e]=function(){n(),t.apply(void 0,_toConsumableArray(r.currentRoute.result))},this.dispatch()}},{key:"addRoute",value:function(e,t){var r=this;if(0!==e.indexOf("#"))throw new Error("Your route should start with a #");this.routes.push(e),this.matchers.push(new RegExp(e.replace(/:[^\s\/]+/g,"([\\w-]+)"))),this.lookup[e]=function(){return t.apply(void 0,_toConsumableArray(r.currentRoute.result))},this.dispatch()}},{key:"addRoutes",value:function(){for(var e=this,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach(function(t){if(0!==t.route.indexOf("#"))throw new Error("Your route should start with a #");e.routes.push(t.route),e.matchers.push(new RegExp(t.route.replace(/:[^\s\/]+/g,"([\\w-]+)"))),e.lookup[t.route]=function(){return t.handler.apply(t,_toConsumableArray(e.currentRoute.result))},e.dispatch()})}},{key:"dispatch",value:function(){var e=null;try{e=new Event("hashchange")}catch(t){e=document.createEvent("Event"),e.initEvent("hashchange",!1,!1)}return window.dispatchEvent(e),this}}]),e}(),ArrayFromPolyfill=function(){Array.from||(Array.from=function(){var e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},r=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t},n=Math.pow(2,53)-1,o=function(e){var t=r(e);return Math.min(Math.max(t,0),n)};return function(e){var r=this,n=Object(e);if(null==e)throw new TypeError("Array.from must use an Array like object - null ou undefined can't be used");var i=arguments.length>1?arguments[1]:void 0,a=void 0;if("undefined"!=typeof i){if(!t(i))throw new TypeError("Array.from: when used, second argument must be a function");arguments.length>2&&(a=arguments[2])}for(var d=o(n.length),s=t(r)?Object(new r(d)):new Array(d),l=0,f=void 0;l<d;)f=n[l],i?s[l]="undefined"==typeof a?i(f,l):i.call(a,f,l):s[l]=f,l+=1;return s.length=d,s}}())}(),Modal=function(){var e=new Router,t=whichAnimationEvent(),r=function(e){a.contains(e.target)||(e.stopPropagation(),a.focus())},n=function(e){27===e.keyCode&&i()},o=function l(e){a.classList.remove("modal-closing"),d.removeEventListener(t,l),document.body.classList.remove("modal-opened"),a=null,d=null,s=null},i=function f(e){e&&e.preventDefault(),a&&(history.back(),window.removeEventListener("keyup",n),document.removeEventListener("focus",r,!0),s.removeEventListener("click",f),a.setAttribute("aria-hidden","true"),a.removeAttribute("aria-label"),t?(a.classList.remove("modal-shown"),a.classList.add("modal-closing"),d.addEventListener(t,o)):(document.body.classList.remove("modal-opened"),a=null,d=null,s=null))},a=void 0,d=void 0,s=void 0;e.addRoutes({route:"#modal/:modalId",handler:function(e,t){a=id("modal/"+e),d=one(".modal-wrapper",a),s=one(".modal-close",a),a.setAttribute("aria-hidden","false"),a.classList.add("modal-shown"),a.setAttribute("tabindex","0"),a.setAttribute("role","dialog"),a.setAttribute("aria-label","Dialog window, press escape to close"),s.setAttribute("aria-label","Press escape to close the dialog window"),s.setAttribute("role","button"),window.addEventListener("keyup",n),document.addEventListener("focus",r,!0),document.body.classList.add("modal-opened"),s.addEventListener("click",i)}})},throttle=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,n=void 0,o=!1;return function(){for(var i=arguments.length,a=Array(i),d=0;d<i;d++)a[d]=arguments[d];var s=function(){e.apply(r,a)};o||(s(),o=!0,n=setTimeout(function(){o=!1},t))}},slugify$1=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n=(t={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ő":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ű":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ő":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ű":"u","'":"-","ý":"y","þ":"th","ÿ":"y","ẞ":"SS","α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ά":"a","έ":"e","ί":"i","ό":"o","ύ":"y","ή":"h","ώ":"w","ς":"s","ϊ":"i","ΰ":"y","ϋ":"y","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Ά":"A","Έ":"E","Ί":"I","Ό":"O","Ύ":"Y","Ή":"H","Ώ":"W","Ϊ":"I","Ϋ":"Y","ş":"s","Ş":"S","ı":"i","İ":"I"},_defineProperty(t,"ç","c"),_defineProperty(t,"Ç","C"),_defineProperty(t,"ü","u"),_defineProperty(t,"Ü","U"),_defineProperty(t,"ö","o"),_defineProperty(t,"Ö","O"),_defineProperty(t,"ğ","g"),_defineProperty(t,"Ğ","G"),_defineProperty(t,"а","a"),_defineProperty(t,"б","b"),_defineProperty(t,"в","v"),_defineProperty(t,"г","g"),_defineProperty(t,"д","d"),_defineProperty(t,"е","e"),_defineProperty(t,"ё","yo"),_defineProperty(t,"ж","zh"),_defineProperty(t,"з","z"),_defineProperty(t,"и","i"),_defineProperty(t,"й","j"),_defineProperty(t,"к","k"),_defineProperty(t,"л","l"),_defineProperty(t,"м","m"),_defineProperty(t,"н","n"),_defineProperty(t,"о","o"),_defineProperty(t,"п","p"),_defineProperty(t,"р","r"),_defineProperty(t,"с","s"),_defineProperty(t,"т","t"),_defineProperty(t,"у","u"),_defineProperty(t,"ф","f"),_defineProperty(t,"х","h"),_defineProperty(t,"ц","c"),_defineProperty(t,"ч","ch"),_defineProperty(t,"ш","sh"),_defineProperty(t,"щ","sh"),_defineProperty(t,"ъ","u"),_defineProperty(t,"ы","y"),_defineProperty(t,"ь",""),_defineProperty(t,"э","e"),_defineProperty(t,"ю","yu"),_defineProperty(t,"я","ya"),_defineProperty(t,"А","A"),_defineProperty(t,"Б","B"),_defineProperty(t,"В","V"),_defineProperty(t,"Г","G"),_defineProperty(t,"Д","D"),_defineProperty(t,"Е","E"),_defineProperty(t,"Ё","Yo"),_defineProperty(t,"Ж","Zh"),_defineProperty(t,"З","Z"),_defineProperty(t,"И","I"),_defineProperty(t,"Й","J"),_defineProperty(t,"К","K"),_defineProperty(t,"Л","L"),_defineProperty(t,"М","M"),_defineProperty(t,"Н","N"),_defineProperty(t,"О","O"),_defineProperty(t,"П","P"),_defineProperty(t,"Р","R"),_defineProperty(t,"С","S"),_defineProperty(t,"Т","T"),_defineProperty(t,"У","U"),_defineProperty(t,"Ф","F"),_defineProperty(t,"Х","H"),_defineProperty(t,"Ц","C"),_defineProperty(t,"Ч","Ch"),_defineProperty(t,"Ш","Sh"),_defineProperty(t,"Щ","Sh"),_defineProperty(t,"Ъ","U"),_defineProperty(t,"Ы","Y"),_defineProperty(t,"Ь",""),_defineProperty(t,"Э","E"),_defineProperty(t,"Ю","Yu"),_defineProperty(t,"Я","Ya"),_defineProperty(t,"Є","Ye"),_defineProperty(t,"І","I"),_defineProperty(t,"Ї","Yi"),_defineProperty(t,"Ґ","G"),_defineProperty(t,"є","ye"),_defineProperty(t,"і","i"),_defineProperty(t,"ї","yi"),_defineProperty(t,"ґ","g"),_defineProperty(t,"č","c"),_defineProperty(t,"ď","d"),_defineProperty(t,"ě","e"),_defineProperty(t,"ň","n"),_defineProperty(t,"ř","r"),_defineProperty(t,"š","s"),_defineProperty(t,"ť","t"),_defineProperty(t,"ů","u"),_defineProperty(t,"ž","z"),_defineProperty(t,"Č","C"),_defineProperty(t,"Ď","D"),_defineProperty(t,"Ě","E"),_defineProperty(t,"Ň","N"),_defineProperty(t,"Ř","R"),_defineProperty(t,"Š","S"),_defineProperty(t,"Ť","T"),_defineProperty(t,"Ů","U"),_defineProperty(t,"Ž","Z"),_defineProperty(t,"ą","a"),_defineProperty(t,"ć","c"),_defineProperty(t,"ę","e"),_defineProperty(t,"ł","l"),_defineProperty(t,"ń","n"),_defineProperty(t,"ó","o"),_defineProperty(t,"ś","s"),_defineProperty(t,"ź","z"),_defineProperty(t,"ż","z"),_defineProperty(t,"Ą","A"),_defineProperty(t,"Ć","C"),_defineProperty(t,"Ę","e"),_defineProperty(t,"Ł","L"),_defineProperty(t,"Ń","N"),_defineProperty(t,"Ś","S"),_defineProperty(t,"Ź","Z"),_defineProperty(t,"Ż","Z"),_defineProperty(t,"ā","a"),_defineProperty(t,"č","c"),_defineProperty(t,"ē","e"),_defineProperty(t,"ģ","g"),_defineProperty(t,"ī","i"),_defineProperty(t,"ķ","k"),_defineProperty(t,"ļ","l"),_defineProperty(t,"ņ","n"),_defineProperty(t,"š","s"),_defineProperty(t,"ū","u"),_defineProperty(t,"ž","z"),_defineProperty(t,"Ā","A"),_defineProperty(t,"Č","C"),_defineProperty(t,"Ē","E"),_defineProperty(t,"Ģ","G"),_defineProperty(t,"Ī","i"),_defineProperty(t,"Ķ","k"),_defineProperty(t,"Ļ","L"),_defineProperty(t,"Ņ","N"),_defineProperty(t,"Š","S"),_defineProperty(t,"Ū","u"),_defineProperty(t,"Ž","Z"),_defineProperty(t,"€","euro"),_defineProperty(t,"₢","cruzeiro"),_defineProperty(t,"₣","french franc"),_defineProperty(t,"£","pound"),_defineProperty(t,"₤","lira"),_defineProperty(t,"₥","mill"),_defineProperty(t,"₦","naira"),_defineProperty(t,"₧","peseta"),_defineProperty(t,"₨","rupee"),_defineProperty(t,"₩","won"),_defineProperty(t,"₪","new shequel"),_defineProperty(t,"₫","dong"),_defineProperty(t,"₭","kip"),_defineProperty(t,"₮","tugrik"),_defineProperty(t,"₯","drachma"),_defineProperty(t,"₰","penny"),_defineProperty(t,"₱","peso"),_defineProperty(t,"₲","guarani"),_defineProperty(t,"₳","austral"),_defineProperty(t,"₴","hryvnia"),_defineProperty(t,"₵","cedi"),_defineProperty(t,"¢","cent"),_defineProperty(t,"¥","yen"),_defineProperty(t,"元","yuan"),_defineProperty(t,"円","yen"),_defineProperty(t,"﷼","rial"),_defineProperty(t,"₠","ecu"),_defineProperty(t,"¤","currency"),_defineProperty(t,"฿","baht"),_defineProperty(t,"$","dollar"),_defineProperty(t,"©","(c)"),_defineProperty(t,"œ","oe"),_defineProperty(t,"Œ","OE"),_defineProperty(t,"∑","sum"),_defineProperty(t,"®","(r)"),_defineProperty(t,"†","+"),_defineProperty(t,"“",'"'),_defineProperty(t,"”",'"'),_defineProperty(t,"‘","'"),_defineProperty(t,"’","'"),_defineProperty(t,"∂","d"),_defineProperty(t,"ƒ","f"),_defineProperty(t,"™","tm"),_defineProperty(t,"℠","sm"),_defineProperty(t,"…","..."),_defineProperty(t,"˚","o"),_defineProperty(t,"º","o"),_defineProperty(t,"ª","a"),_defineProperty(t,"•","*"),_defineProperty(t,"∆","delta"),_defineProperty(t,"∞","infinity"),_defineProperty(t,"♥","love"),_defineProperty(t,"&","and"),_defineProperty(t,"|","or"),_defineProperty(t,"<","less"),_defineProperty(t,">","greater"),t);return e.split("").reduce(function(e,t){return n[t]&&(t=n[t]),t=t.replace(/[^\w\s$*_+~.()'"!\-:@]/g,""),e+=t},"").replace(/^\s+|\s+$/g,"").replace(/[-\s]+/g,r||"-").replace("#{replacement}$","")},PRNG=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;_classCallCheck(this,e),this.x=0,this.seed=t}return _createClass(e,[{key:"gen",value:function(){return this.x=1e4*Math.sin(this.seed++),this.x-Math.floor(this.x)}}]),e}(),prng=new PRNG(Date.now()),ArrayIncludesPolyfill=function(){Array.prototype.includes||(Array.prototype.includes=function(e){if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");var t=Object(this),r=parseInt(t.length,10)||0;if(0===r)return!1;var n=parseInt(arguments[1],10)||0,o=void 0;n>=0?o=n:(o=r+n,o<0&&(o=0));for(var i=void 0;o<r;){if(i=t[o],e===i||e!==e&&i!==i)return!0;o++}return!1})}(),attributeExceptions=["role","dataset","d","width","height","viewBox"],SVG_NAMESPACE="http://www.w3.org/2000/svg",appendText=function(e,t){var r=document.createTextNode(t);e.appendChild(r)},appendArray=function e(t,r){r.forEach(function(r){Array.isArray(r)?e(t,r):r instanceof window.Element?t.appendChild(r):"string"!=typeof r&&"number"!=typeof r||appendText(t,r)})},setStyles=function(e,t){return t?void Object.keys(t).forEach(function(r){r in e.style?e.style[r]=t[r]:console.warn(r+" is not a valid style for a <"+e.tagName.toLowerCase()+">")}):void e.removeAttribute("styles")},setDataAttributes=function(e,t){Object.keys(t).forEach(function(r){e.setAttribute("data-"+r,t[r])})},isSvg=function(e){return["path","svg"].includes(e)},makeElement=function(e,t){for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];var i=isSvg(e)?document.createElementNS(SVG_NAMESPACE,e):document.createElement(e);return Array.isArray(t)?appendArray(i,t):t instanceof window.Element?i.appendChild(t):"string"==typeof t||"number"==typeof t?appendText(i,t):"object"==typeof t&&Object.keys(t).forEach(function(r){if(r in i||attributeExceptions.includes(r)){var n=t[r];"style"===r?setStyles(i,n):"dataset"===r?setDataAttributes(i,n):"function"==typeof n||"className"===r?i[r]=n:n&&i.setAttribute(r,n)}else console.warn(r+" is not a valid property of a <"+e+">")}),n&&appendArray(i,n),i},a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return makeElement.apply(void 0,["a"].concat(t))},article=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return makeElement.apply(void 0,["article"].concat(t))},div=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return makeElement.apply(void 0,["div"].concat(t))},h2=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return makeElement.apply(void 0,["h2"].concat(t))},img=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return makeElement.apply(void 0,["img"].concat(t))},consolePolyfill=function(){for(var e=void 0,t=function(){},r=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],n=r.length,o=window.console=window.console||{};n--;)e=r[n],o[e]||(o[e]=t)}(),classListPolyfill=function(){/*
    * classList.js: Cross-browser full element.classList implementation.
    * 1.1.20150312
    *
    * By Eli Grey, http://eligrey.com
    * License: Dedicated to the public domain.
    *   See https://github.com/eligrey/classList.js/blob/master/LICENSE.md
    */
/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js */
"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?!function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){var r,n=arguments.length;for(r=0;r<n;r++)e=arguments[r],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var r=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:r.call(this,e)}}e=null}():!function(e){if("Element"in e){var t="classList",r="prototype",n=e.Element[r],o=Object,i=String[r].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[r].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1},d=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},s=function(e,t){if(""===t)throw new d("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new d("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(e,t)},l=function(e){for(var t=i.call(e.getAttribute("class")||""),r=t?t.split(/\s+/):[],n=0,o=r.length;n<o;n++)this.push(r[n]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},f=l[r]=[],u=function(){return new l(this)};if(d[r]=Error[r],f.item=function(e){return this[e]||null},f.contains=function(e){return e+="",s(this,e)!==-1},f.add=function(){var e,t=arguments,r=0,n=t.length,o=!1;do e=t[r]+"",s(this,e)===-1&&(this.push(e),o=!0);while(++r<n);o&&this._updateClassName()},f.remove=function(){var e,t,r=arguments,n=0,o=r.length,i=!1;do for(e=r[n]+"",t=s(this,e);t!==-1;)this.splice(t,1),i=!0,t=s(this,e);while(++n<o);i&&this._updateClassName()},f.toggle=function(e,t){e+="";var r=this.contains(e),n=r?t!==!0&&"remove":t!==!1&&"add";return n&&this[n](e),t===!0||t===!1?t:!r},f.toString=function(){return this.join(" ")},o.defineProperty){var c={get:u,enumerable:!0,configurable:!0};try{o.defineProperty(n,t,c)}catch(p){p.number===-2146823252&&(c.enumerable=!1,o.defineProperty(n,t,c))}}else o[r].__defineGetter__&&n.__defineGetter__(t,u)}}(self))}(),texture=id("texture"),textureCtx=texture.getContext("2d"),body$$1=one("body"),modalBuilder=function(e){return div({className:"modal",id:"modal/"+slugify$1(e.title),dataset:{title:slugify$1(e.title)}},div({className:"modal-wrapper"},div({className:"modal-content"},h2(),article()),a({className:"modal-close",href:"#"},"Fermer")))},handleResize=throttle(function(e){scale=Math.max(1400,body$$1.offsetHeight,body$$1.offsetWidth),texture.width=scale,texture.height=scale,offsetLeft=(body$$1.offsetWidth-scale>>1)/scale,offsetTop=(body$$1.offsetHeight-scale>>1)/scale,fillTexture(!0)}),handleMousedown=function(e){body$$1.classList.contains("modal-opened")||(clickTime=Date.now(),body$$1.classList.add("grabbing"),grabbing=!0,mx=e.pageX/scale,my=e.pageY/scale)},handleMousemove=function(e){if(!body$$1.classList.contains("modal-opened")){if(grabbing){var t=e.pageX/scale-mx,r=e.pageY/scale-my;dx+=t,dy+=r}mx-=x,my-=y;var n=dataSet.find(function(e){return mx>e.area.left&&mx<e.area.right&&my>e.area.top&&my<e.area.bottom});body$$1.classList[n?"add":"remove"]("hover"),mx=e.pageX/scale,my=e.pageY/scale}},handleMouseup=function(e){if(!body$$1.classList.contains("modal-opened")){if(mx=e.pageX/scale-x,my=e.pageY/scale-y,Date.now()-clickTime<150){var t=dataSet.reverse().find(function(e){return mx>e.area.left&&mx<e.area.right&&my>e.area.top&&my<e.area.bottom});t&&(document.location.href="#modal/"+t.slug),dataSet.reverse()}grabbing=!1,body$$1.classList.remove("grabbing")}},touchDown=function(e){handleMousedown({pageX:e.touches[0].pageX,pageY:e.touches[0].pageY})},touchMove=function(e){handleMousemove({pageX:e.touches[0].pageX,pageY:e.touches[0].pageY})},touchEnd=function(e){handleMouseup({pageX:e.touches[0].pageX,pageY:e.touches[0].pageY})},handleKeydown=function(e){if(!body$$1.classList.contains("modal-opened")){switch(e.keyCode){case 38:dy+=.1;break;case 40:dy-=.1;break;case 39:dx-=.1;break;case 37:dx+=.1;break;case 9:void 0===selectedKnowledge?selectedKnowledge=0:(selectedKnowledge+=e.shiftKey?-1:1,selectedKnowledge<0&&(selectedKnowledge=dataSet.length-1),selectedKnowledge>dataSet.length-1&&(selectedKnowledge=0)),console.log(dataSet[selectedKnowledge].area.width),dx=.5+offsetLeft-dataSet[selectedKnowledge].area.left-.5*dataSet[selectedKnowledge].area.width,dy=.5+offsetTop-dataSet[selectedKnowledge].area.top-.5*dataSet[selectedKnowledge].area.height;break;case 32:case 13:document.location.href="#modal/"+dataSet[selectedKnowledge||0].slug}e.preventDefault(),e.stopPropagation()}},addListeners=function(e){e?(body$$1.addEventListener("mousedown",handleMousedown),body$$1.addEventListener("mousemove",handleMousemove),body$$1.addEventListener("mouseup",handleMouseup),body$$1.addEventListener("touchstart",touchDown,!1),body$$1.addEventListener("touchmove",touchMove,!1),body$$1.addEventListener("touchend",touchEnd,!1),body$$1.addEventListener("keydown",handleKeydown)):window.addEventListener("resize",handleResize)},drawSpiral=function(){for(var e=0,t=0,r=1,n=1,o=imgsLoaded,i=0,a=0;i<o;){for(;2*e*r<n&&!(a>=imgsLoaded);)e+=r,drawImage(a,e,t),a++;for(;2*t*r<n&&!(a>=imgsLoaded);)t+=r,drawImage(a,e,t),a++;if(a>=imgsLoaded)break;r=-1*r,n+=1,i++}},drawImage=function(e,t,r){t*=.3,r*=.3,textureCtx.save(),textureCtx.translate(t*scale+x*scale,r*scale+y*scale),dataSet[e].area={left:t,top:r,right:t+dataSet[e].imageData.width/scale,bottom:r+dataSet[e].imageData.height/scale,width:dataSet[e].imageData.width/scale,height:dataSet[e].imageData.height/scale},textureCtx.drawImage(dataSet[e].imageData,0,0,dataSet[e].imageData.width,dataSet[e].imageData.height),textureCtx.restore()},initApp=function(){loadData().then(loadImages,logError),loadTexture()},loadData=function(){return new Promise(function(e,t){var r=new XMLHttpRequest;r.open("GET","data/data.json",!0),r.onload=function(){200===r.status?e(JSON.parse(r.responseText)):t(Error(r.statusText))},r.onerror=function(){t(Error("Network Error"))},r.send()})},logError=function(e){return console.log(e)},initData=function(e){dataSet=e,imgsQty=e.length,dataSet.forEach(function(e,t){e.slug=slugify$1(e.title),e.index=t,e.area={left:0,top:0,right:0,bottom:0},body$$1.appendChild(modalBuilder(e))})},initModalAndRouter=function(){Modal(),(new Router).dispatch().extendRoute("#modal/:modalId",function(e,t){var r=dataSet.find(function(t){return t.slug===e});if(r&&(one('[data-title="'+r.slug+'"] h2').textContent=r.title,one('[data-title="'+r.slug+'"] article').innerHTML=r.text,selectedKnowledge=r.index,r.media)){var n=img({src:r.media});one('[data-title="'+r.slug+'"] article').insertBefore(n,one('[data-title="'+r.slug+'"] article').firstChild)}})},loadImages=function t(e){e&&(initData(e),initModalAndRouter());var r=new Image;r.onload=function(e){dataSet[imgsLoaded].imageData=e.target,imgsLoaded++,imgsLoaded<imgsQty&&t(),1===imgsLoaded&&addListeners(!0)},r.src=dataSet[imgsLoaded].image},loadTexture=function(){var e=new Image;e.onload=function(){texturePattern=textureCtx.createPattern(e,"repeat"),fillTexture(!0),render()},e.src="img/texture.jpg"},fillTexture=function(e){e&&(textureCtx.fillStyle=texturePattern),textureCtx.fillRect(-(x*scale),-(y*scale),scale,scale)},render=function r(){requestAnimationFrame(r),renderTexture(),drawSpiral()},renderTexture=function(){x+=.1*(dx-x),y+=.1*(dy-y),textureCtx.save(),textureCtx.translate(x*scale,y*scale),fillTexture(),textureCtx.restore()},texturePattern=void 0,imgsQty=void 0,dataSet=void 0,selectedKnowledge=void 0,imgsLoaded=0,images=[],scale=void 0,offsetTop=void 0,offsetLeft=void 0,grabbing=!1,dx=0,dy=0,x=0,y=0,mx=void 0,my=void 0,clickTime=void 0;handleResize(),addListeners(),initApp();